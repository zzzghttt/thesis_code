[2024-11-16 18:42:29,366] pyg_homo_model_train.py: INFO:
**********************************************************************************************************************************************************************************************

MODEL ARCHITECTURE:
Graph_Model(
  (layer_convs): ModuleList(
    (0-1): 2 x GCNConv(-1, 512)
  )
  (output_layer_lin1): Linear(-1, 512, bias=True)
  (output_layer_lin2): Linear(512, 1, bias=True)
  (sigmoid): Sigmoid()
)
**********************************************************************************************************************************************************************************************
[2024-11-16 18:42:29,367] utility.py: INFO: [EarlyStopper]: Saving model to /Users/chenyi/Documents/sag/Final_Project/data/model_res/GCN/checkpoints/GCN_128_0.001_0.01_2_2_512_[10, 10]_early_stop_202411161842.pth
[2024-11-16 18:42:29,367] pyg_homo_model_train.py: INFO: Train on epoch    0:
[2024-11-16 18:42:29,382] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.7099177241325378}
[2024-11-16 18:42:29,386] pyg_homo_model_train.py: INFO: epoch:0 - ROC_AUC: 0.21458333333333335; PR_AUC: 0.612741531360137; KS: 0.6666666666666666; R@0.95P: 0; threhold: 0; P@0.95R: 0.7755102040816326; threhold: 0.7496055364608765;
[2024-11-16 18:42:29,389] pyg_homo_model_train.py: INFO: Train on epoch    1:
[2024-11-16 18:42:29,393] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.8368562459945679}
[2024-11-16 18:42:29,393] pyg_homo_model_train.py: INFO: Train on epoch    2:
[2024-11-16 18:42:29,396] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.5417032837867737}
[2024-11-16 18:42:29,396] pyg_homo_model_train.py: INFO: Train on epoch    3:
[2024-11-16 18:42:29,400] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.5367960333824158}
[2024-11-16 18:42:29,400] pyg_homo_model_train.py: INFO: Train on epoch    4:
[2024-11-16 18:42:29,402] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.5247559547424316}
[2024-11-16 18:42:29,402] pyg_homo_model_train.py: INFO: Train on epoch    5:
[2024-11-16 18:42:29,405] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.4473077654838562}
[2024-11-16 18:42:29,409] pyg_homo_model_train.py: INFO: epoch:5 - ROC_AUC: 0.7583333333333334; PR_AUC: 0.9263690573884852; KS: 0.6916666666666667; R@0.95P: 0.775; threhold: 0.8069207668304443; P@0.95R: 0.7755102040816326; threhold: 0.5406239628791809;
[2024-11-16 18:42:29,411] pyg_homo_model_train.py: INFO: Train on epoch    6:
[2024-11-16 18:42:29,414] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.4426041841506958}
[2024-11-16 18:42:29,414] pyg_homo_model_train.py: INFO: Train on epoch    7:
[2024-11-16 18:42:29,417] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.445522665977478}
[2024-11-16 18:42:29,417] pyg_homo_model_train.py: INFO: Train on epoch    8:
[2024-11-16 18:42:29,420] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.4049566984176636}
[2024-11-16 18:42:29,420] pyg_homo_model_train.py: INFO: Train on epoch    9:
[2024-11-16 18:42:29,423] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.3855951428413391}
[2024-11-16 18:42:29,423] pyg_homo_model_train.py: INFO: Train on epoch   10:
[2024-11-16 18:42:29,427] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.3904867470264435}
[2024-11-16 18:42:29,430] pyg_homo_model_train.py: INFO: epoch:10 - ROC_AUC: 0.9104166666666667; PR_AUC: 0.9736062616619422; KS: 0.775; R@0.95P: 0.775; threhold: 0.7986436486244202; P@0.95R: 0.8837209302325582; threhold: 0.2611640393733978;
[2024-11-16 18:42:29,432] pyg_homo_model_train.py: INFO: Train on epoch   11:
[2024-11-16 18:42:29,435] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.38458460569381714}
[2024-11-16 18:42:29,435] pyg_homo_model_train.py: INFO: Train on epoch   12:
[2024-11-16 18:42:29,438] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.3591786026954651}
[2024-11-16 18:42:29,438] pyg_homo_model_train.py: INFO: Train on epoch   13:
[2024-11-16 18:42:29,442] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.34397682547569275}
[2024-11-16 18:42:29,442] pyg_homo_model_train.py: INFO: Train on epoch   14:
[2024-11-16 18:42:29,445] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.3423965871334076}
[2024-11-16 18:42:29,445] pyg_homo_model_train.py: INFO: Train on epoch   15:
[2024-11-16 18:42:29,448] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.3356509506702423}
[2024-11-16 18:42:29,451] pyg_homo_model_train.py: INFO: epoch:15 - ROC_AUC: 0.9104166666666665; PR_AUC: 0.9747867700111642; KS: 0.775; R@0.95P: 0.775; threhold: 0.7652103900909424; P@0.95R: 0.9047619047619048; threhold: 0.4870288372039795;
[2024-11-16 18:42:29,453] pyg_homo_model_train.py: INFO: Train on epoch   16:
[2024-11-16 18:42:29,456] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.32044094800949097}
[2024-11-16 18:42:29,456] pyg_homo_model_train.py: INFO: Train on epoch   17:
[2024-11-16 18:42:29,460] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.30646178126335144}
[2024-11-16 18:42:29,460] pyg_homo_model_train.py: INFO: Train on epoch   18:
[2024-11-16 18:42:29,463] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.3015751540660858}
[2024-11-16 18:42:29,463] pyg_homo_model_train.py: INFO: Train on epoch   19:
[2024-11-16 18:42:29,466] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.29321277141571045}
[2024-11-16 18:42:29,466] pyg_homo_model_train.py: INFO: Train on epoch   20:
[2024-11-16 18:42:29,469] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.2805260419845581}
[2024-11-16 18:42:29,471] pyg_homo_model_train.py: INFO: epoch:20 - ROC_AUC: 0.9604166666666667; PR_AUC: 0.9878383044939145; KS: 0.7833333333333333; R@0.95P: 0.95; threhold: 0.4583641290664673; P@0.95R: 0.95; threhold: 0.4583641290664673;
[2024-11-16 18:42:29,474] pyg_homo_model_train.py: INFO: Train on epoch   21:
[2024-11-16 18:42:29,477] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.2680433392524719}
[2024-11-16 18:42:29,477] pyg_homo_model_train.py: INFO: Train on epoch   22:
[2024-11-16 18:42:29,479] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.26186826825141907}
[2024-11-16 18:42:29,479] pyg_homo_model_train.py: INFO: Train on epoch   23:
[2024-11-16 18:42:29,482] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.2523100972175598}
[2024-11-16 18:42:29,482] pyg_homo_model_train.py: INFO: Train on epoch   24:
[2024-11-16 18:42:29,485] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.23934435844421387}
[2024-11-16 18:42:29,485] pyg_homo_model_train.py: INFO: Train on epoch   25:
[2024-11-16 18:42:29,488] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.22973282635211945}
[2024-11-16 18:42:29,490] pyg_homo_model_train.py: INFO: epoch:25 - ROC_AUC: 0.9916666666666666; PR_AUC: 0.997433363735514; KS: 0.9166666666666666; R@0.95P: 1.0; threhold: 0.32553401589393616; P@0.95R: 0.9743589743589743; threhold: 0.4752456247806549;
[2024-11-16 18:42:29,493] pyg_homo_model_train.py: INFO: Train on epoch   26:
[2024-11-16 18:42:29,496] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.21921542286872864}
[2024-11-16 18:42:29,496] pyg_homo_model_train.py: INFO: Train on epoch   27:
[2024-11-16 18:42:29,500] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.20833055675029755}
[2024-11-16 18:42:29,500] pyg_homo_model_train.py: INFO: Train on epoch   28:
[2024-11-16 18:42:29,503] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.19738538563251495}
[2024-11-16 18:42:29,503] pyg_homo_model_train.py: INFO: Train on epoch   29:
[2024-11-16 18:42:29,506] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.1879909336566925}
[2024-11-16 18:42:29,506] pyg_homo_model_train.py: INFO: Train on epoch   30:
[2024-11-16 18:42:29,510] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.17325779795646667}
[2024-11-16 18:42:29,513] pyg_homo_model_train.py: INFO: epoch:30 - ROC_AUC: 1.0; PR_AUC: 1.0; KS: 1.0; R@0.95P: 1.0; threhold: 0.3093515932559967; P@0.95R: 1.0; threhold: 0.5559455752372742;
[2024-11-16 18:42:29,515] pyg_homo_model_train.py: INFO: Train on epoch   31:
[2024-11-16 18:42:29,518] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.16271980106830597}
[2024-11-16 18:42:29,518] pyg_homo_model_train.py: INFO: Train on epoch   32:
[2024-11-16 18:42:29,521] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.15039092302322388}
[2024-11-16 18:42:29,521] pyg_homo_model_train.py: INFO: Train on epoch   33:
[2024-11-16 18:42:29,523] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.13881008327007294}
[2024-11-16 18:42:29,523] pyg_homo_model_train.py: INFO: Train on epoch   34:
[2024-11-16 18:42:29,527] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.1272987425327301}
[2024-11-16 18:42:29,527] pyg_homo_model_train.py: INFO: Train on epoch   35:
[2024-11-16 18:42:29,530] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.11547446995973587}
[2024-11-16 18:42:29,532] pyg_homo_model_train.py: INFO: epoch:35 - ROC_AUC: 1.0; PR_AUC: 1.0; KS: 1.0; R@0.95P: 1.0; threhold: 0.1802055835723877; P@0.95R: 1.0; threhold: 0.6730789542198181;
[2024-11-16 18:42:29,535] pyg_homo_model_train.py: INFO: Train on epoch   36:
[2024-11-16 18:42:29,538] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.10486619174480438}
[2024-11-16 18:42:29,538] pyg_homo_model_train.py: INFO: Train on epoch   37:
[2024-11-16 18:42:29,540] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.0934026688337326}
[2024-11-16 18:42:29,541] pyg_homo_model_train.py: INFO: Train on epoch   38:
[2024-11-16 18:42:29,544] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.08472894132137299}
[2024-11-16 18:42:29,544] pyg_homo_model_train.py: INFO: Train on epoch   39:
[2024-11-16 18:42:29,547] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.07460279762744904}
[2024-11-16 18:42:29,547] pyg_homo_model_train.py: INFO: Train on epoch   40:
[2024-11-16 18:42:29,551] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.06772470474243164}
[2024-11-16 18:42:29,553] pyg_homo_model_train.py: INFO: epoch:40 - ROC_AUC: 1.0; PR_AUC: 1.0; KS: 1.0; R@0.95P: 1.0; threhold: 0.1384895294904709; P@0.95R: 1.0; threhold: 0.8409507870674133;
[2024-11-16 18:42:29,556] pyg_homo_model_train.py: INFO: Train on epoch   41:
[2024-11-16 18:42:29,559] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.05845189839601517}
[2024-11-16 18:42:29,559] pyg_homo_model_train.py: INFO: Train on epoch   42:
[2024-11-16 18:42:29,562] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.05235372483730316}
[2024-11-16 18:42:29,562] pyg_homo_model_train.py: INFO: Train on epoch   43:
[2024-11-16 18:42:29,565] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.04701131954789162}
[2024-11-16 18:42:29,565] pyg_homo_model_train.py: INFO: Train on epoch   44:
[2024-11-16 18:42:29,568] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.04234844818711281}
[2024-11-16 18:42:29,568] pyg_homo_model_train.py: INFO: Train on epoch   45:
[2024-11-16 18:42:29,570] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.03790583088994026}
[2024-11-16 18:42:29,573] pyg_homo_model_train.py: INFO: epoch:45 - ROC_AUC: 1.0; PR_AUC: 1.0; KS: 1.0; R@0.95P: 1.0; threhold: 0.09096810221672058; P@0.95R: 1.0; threhold: 0.9250994920730591;
[2024-11-16 18:42:29,576] pyg_homo_model_train.py: INFO: Train on epoch   46:
[2024-11-16 18:42:29,579] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.034346215426921844}
[2024-11-16 18:42:29,579] pyg_homo_model_train.py: INFO: Train on epoch   47:
[2024-11-16 18:42:29,582] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.03037353605031967}
[2024-11-16 18:42:29,582] pyg_homo_model_train.py: INFO: Train on epoch   48:
[2024-11-16 18:42:29,584] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.028196068480610847}
[2024-11-16 18:42:29,584] pyg_homo_model_train.py: INFO: Train on epoch   49:
[2024-11-16 18:42:29,587] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.026039807125926018}
[2024-11-16 18:42:29,587] pyg_homo_model_train.py: INFO: Train on epoch   50:
[2024-11-16 18:42:29,589] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.024446377530694008}
[2024-11-16 18:42:29,593] pyg_homo_model_train.py: INFO: epoch:50 - ROC_AUC: 1.0; PR_AUC: 1.0; KS: 1.0; R@0.95P: 1.0; threhold: 0.07362732291221619; P@0.95R: 1.0; threhold: 0.9320528507232666;
[2024-11-16 18:42:29,596] pyg_homo_model_train.py: INFO: Train on epoch   51:
[2024-11-16 18:42:29,598] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.022720694541931152}
[2024-11-16 18:42:29,599] pyg_homo_model_train.py: INFO: Train on epoch   52:
[2024-11-16 18:42:29,601] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.021554062142968178}
[2024-11-16 18:42:29,602] pyg_homo_model_train.py: INFO: Train on epoch   53:
[2024-11-16 18:42:29,604] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.020513853058218956}
[2024-11-16 18:42:29,605] pyg_homo_model_train.py: INFO: Train on epoch   54:
[2024-11-16 18:42:29,608] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.020012905821204185}
[2024-11-16 18:42:29,608] pyg_homo_model_train.py: INFO: Train on epoch   55:
[2024-11-16 18:42:29,610] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.01901993341743946}
[2024-11-16 18:42:29,613] pyg_homo_model_train.py: INFO: epoch:55 - ROC_AUC: 1.0; PR_AUC: 1.0; KS: 1.0; R@0.95P: 1.0; threhold: 0.04896724596619606; P@0.95R: 1.0; threhold: 0.9410149455070496;
[2024-11-16 18:42:29,615] pyg_homo_model_train.py: INFO: Train on epoch   56:
[2024-11-16 18:42:29,618] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.018915651366114616}
[2024-11-16 18:42:29,618] pyg_homo_model_train.py: INFO: Train on epoch   57:
[2024-11-16 18:42:29,621] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.018400099128484726}
[2024-11-16 18:42:29,621] pyg_homo_model_train.py: INFO: Train on epoch   58:
[2024-11-16 18:42:29,624] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.018201062455773354}
[2024-11-16 18:42:29,624] pyg_homo_model_train.py: INFO: Train on epoch   59:
[2024-11-16 18:42:29,627] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.01776171661913395}
[2024-11-16 18:42:29,627] pyg_homo_model_train.py: INFO: Train on epoch   60:
[2024-11-16 18:42:29,630] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.018035344779491425}
[2024-11-16 18:42:29,632] pyg_homo_model_train.py: INFO: epoch:60 - ROC_AUC: 1.0; PR_AUC: 1.0; KS: 1.0; R@0.95P: 1.0; threhold: 0.04448988661170006; P@0.95R: 1.0; threhold: 0.9396976828575134;
[2024-11-16 18:42:29,635] pyg_homo_model_train.py: INFO: Train on epoch   61:
[2024-11-16 18:42:29,638] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.01857616938650608}
[2024-11-16 18:42:29,638] pyg_homo_model_train.py: INFO: Train on epoch   62:
[2024-11-16 18:42:29,642] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.018348589539527893}
[2024-11-16 18:42:29,642] pyg_homo_model_train.py: INFO: Train on epoch   63:
[2024-11-16 18:42:29,644] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.018680008128285408}
[2024-11-16 18:42:29,644] pyg_homo_model_train.py: INFO: Train on epoch   64:
[2024-11-16 18:42:29,647] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.019375434145331383}
[2024-11-16 18:42:29,647] pyg_homo_model_train.py: INFO: Train on epoch   65:
[2024-11-16 18:42:29,650] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.018913788720965385}
[2024-11-16 18:42:29,653] pyg_homo_model_train.py: INFO: epoch:65 - ROC_AUC: 1.0; PR_AUC: 0.9999999999999999; KS: 1.0; R@0.95P: 1.0; threhold: 0.04919538274407387; P@0.95R: 1.0; threhold: 0.9393861889839172;
[2024-11-16 18:42:29,655] pyg_homo_model_train.py: INFO: Train on epoch   66:
[2024-11-16 18:42:29,659] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.019245725125074387}
[2024-11-16 18:42:29,659] pyg_homo_model_train.py: INFO: Train on epoch   67:
[2024-11-16 18:42:29,662] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.01948688179254532}
[2024-11-16 18:42:29,662] pyg_homo_model_train.py: INFO: Train on epoch   68:
[2024-11-16 18:42:29,665] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.01966267079114914}
[2024-11-16 18:42:29,665] pyg_homo_model_train.py: INFO: Train on epoch   69:
[2024-11-16 18:42:29,668] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.020323021337389946}
[2024-11-16 18:42:29,668] pyg_homo_model_train.py: INFO: Train on epoch   70:
[2024-11-16 18:42:29,671] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.020309345796704292}
[2024-11-16 18:42:29,674] pyg_homo_model_train.py: INFO: epoch:70 - ROC_AUC: 1.0; PR_AUC: 1.0; KS: 1.0; R@0.95P: 1.0; threhold: 0.04419437795877457; P@0.95R: 1.0; threhold: 0.931650698184967;
[2024-11-16 18:42:29,677] pyg_homo_model_train.py: INFO: Train on epoch   71:
[2024-11-16 18:42:29,680] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.020459534600377083}
[2024-11-16 18:42:29,680] pyg_homo_model_train.py: INFO: Train on epoch   72:
[2024-11-16 18:42:29,683] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.020077692344784737}
[2024-11-16 18:42:29,683] pyg_homo_model_train.py: INFO: Train on epoch   73:
[2024-11-16 18:42:29,686] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.020596861839294434}
[2024-11-16 18:42:29,686] pyg_homo_model_train.py: INFO: Train on epoch   74:
[2024-11-16 18:42:29,688] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.02094244211912155}
[2024-11-16 18:42:29,688] pyg_homo_model_train.py: INFO: Train on epoch   75:
[2024-11-16 18:42:29,691] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.02038843370974064}
[2024-11-16 18:42:29,694] pyg_homo_model_train.py: INFO: epoch:75 - ROC_AUC: 1.0; PR_AUC: 1.0; KS: 1.0; R@0.95P: 1.0; threhold: 0.04021461680531502; P@0.95R: 1.0; threhold: 0.928341805934906;
[2024-11-16 18:42:29,697] pyg_homo_model_train.py: INFO: Train on epoch   76:
[2024-11-16 18:42:29,699] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.021088631823658943}
[2024-11-16 18:42:29,699] pyg_homo_model_train.py: INFO: Train on epoch   77:
[2024-11-16 18:42:29,702] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.020447012037038803}
[2024-11-16 18:42:29,702] pyg_homo_model_train.py: INFO: Train on epoch   78:
[2024-11-16 18:42:29,704] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.0200122632086277}
[2024-11-16 18:42:29,705] pyg_homo_model_train.py: INFO: Train on epoch   79:
[2024-11-16 18:42:29,709] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.019565515220165253}
[2024-11-16 18:42:29,709] pyg_homo_model_train.py: INFO: Train on epoch   80:
[2024-11-16 18:42:29,712] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.01914125867187977}
[2024-11-16 18:42:29,715] pyg_homo_model_train.py: INFO: epoch:80 - ROC_AUC: 1.0; PR_AUC: 1.0; KS: 1.0; R@0.95P: 1.0; threhold: 0.04412508010864258; P@0.95R: 1.0; threhold: 0.9311837553977966;
[2024-11-16 18:42:29,720] pyg_homo_model_train.py: INFO: Train on epoch   81:
[2024-11-16 18:42:29,722] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.01868579536676407}
[2024-11-16 18:42:29,722] pyg_homo_model_train.py: INFO: Train on epoch   82:
[2024-11-16 18:42:29,726] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.018706541508436203}
[2024-11-16 18:42:29,726] pyg_homo_model_train.py: INFO: Train on epoch   83:
[2024-11-16 18:42:29,728] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.017508313059806824}
[2024-11-16 18:42:29,728] pyg_homo_model_train.py: INFO: Train on epoch   84:
[2024-11-16 18:42:29,730] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.017866704612970352}
[2024-11-16 18:42:29,731] pyg_homo_model_train.py: INFO: Train on epoch   85:
[2024-11-16 18:42:29,733] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.017572106793522835}
[2024-11-16 18:42:29,736] pyg_homo_model_train.py: INFO: epoch:85 - ROC_AUC: 1.0; PR_AUC: 1.0; KS: 1.0; R@0.95P: 1.0; threhold: 0.028606897220015526; P@0.95R: 1.0; threhold: 0.9278531670570374;
[2024-11-16 18:42:29,741] pyg_homo_model_train.py: INFO: Train on epoch   86:
[2024-11-16 18:42:29,744] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.017135338857769966}
[2024-11-16 18:42:29,744] pyg_homo_model_train.py: INFO: Train on epoch   87:
[2024-11-16 18:42:29,746] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.016327716410160065}
[2024-11-16 18:42:29,746] pyg_homo_model_train.py: INFO: Train on epoch   88:
[2024-11-16 18:42:29,749] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.015694277361035347}
[2024-11-16 18:42:29,749] pyg_homo_model_train.py: INFO: Train on epoch   89:
[2024-11-16 18:42:29,752] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.015461674891412258}
[2024-11-16 18:42:29,752] pyg_homo_model_train.py: INFO: Train on epoch   90:
[2024-11-16 18:42:29,755] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.01545017957687378}
[2024-11-16 18:42:29,758] pyg_homo_model_train.py: INFO: epoch:90 - ROC_AUC: 1.0; PR_AUC: 1.0; KS: 1.0; R@0.95P: 1.0; threhold: 0.029415840283036232; P@0.95R: 1.0; threhold: 0.9368565678596497;
[2024-11-16 18:42:29,761] pyg_homo_model_train.py: INFO: Train on epoch   91:
[2024-11-16 18:42:29,764] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.015441632829606533}
[2024-11-16 18:42:29,764] pyg_homo_model_train.py: INFO: Train on epoch   92:
[2024-11-16 18:42:29,766] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.015030200593173504}
[2024-11-16 18:42:29,766] pyg_homo_model_train.py: INFO: Train on epoch   93:
[2024-11-16 18:42:29,769] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.014908527955412865}
[2024-11-16 18:42:29,769] pyg_homo_model_train.py: INFO: Train on epoch   94:
[2024-11-16 18:42:29,771] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.014343314804136753}
[2024-11-16 18:42:29,771] pyg_homo_model_train.py: INFO: Train on epoch   95:
[2024-11-16 18:42:29,774] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.013796537183225155}
[2024-11-16 18:42:29,777] pyg_homo_model_train.py: INFO: epoch:95 - ROC_AUC: 1.0; PR_AUC: 1.0; KS: 1.0; R@0.95P: 1.0; threhold: 0.039537474513053894; P@0.95R: 1.0; threhold: 0.9452310800552368;
[2024-11-16 18:42:29,780] pyg_homo_model_train.py: INFO: Train on epoch   96:
[2024-11-16 18:42:29,782] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.013689949177205563}
[2024-11-16 18:42:29,782] pyg_homo_model_train.py: INFO: Train on epoch   97:
[2024-11-16 18:42:29,786] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.013411471620202065}
[2024-11-16 18:42:29,786] pyg_homo_model_train.py: INFO: Train on epoch   98:
[2024-11-16 18:42:29,788] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.013474484905600548}
[2024-11-16 18:42:29,788] pyg_homo_model_train.py: INFO: Train on epoch   99:
[2024-11-16 18:42:29,791] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.013193805702030659}
[2024-11-16 18:42:29,791] pyg_homo_model_train.py: INFO:
Best Epoch 95, Val 1.0000
/Users/chenyi/Documents/sag/Final_Project/train_scripts/utils/utility.py:193: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(self.save_path))
[2024-11-16 18:42:29,795] pyg_homo_model_train.py: INFO:
Best Epoch 95 - ROC_AUC: 1.0; PR_AUC: 1.0; KS: 1.0; R@0.95P: 1.0; threhold: 0.039537474513053894; P@0.95R: 1.0; threhold: 0.9452310800552368;
[2024-11-16 18:42:29,795] val_inference_homo.py: INFO: config file path is config/config.yaml
[2024-11-16 18:42:29,798] val_inference_homo.py: INFO:
**********************************************************************************************************************************************************************************************

DATASET_CONFIG:
DATASET_PATH:
    EDGE_TYPES:
    - class_to_class
    SAVE2FILE_ROOTPATH: /Users/chenyi/Documents/sag/Final_Project/data
    NODE_FEATURE_SAVE2FILE_PATH: /Users/chenyi/Documents/sag/Final_Project/data/{DATA_TYPE}/node_feature
    EDGE_INDEX_SAVE2FILE_PATH: /Users/chenyi/Documents/sag/Final_Project/data/{DATA_TYPE}/edge_index
    PYG_GRAPH_SAVE2FILE_PATH: /Users/chenyi/Documents/sag/Final_Project/data/pyg_graph/{DATA_TYPE}
    FEATURE_SAVE2FILE_PATH: /Users/chenyi/Documents/sag/Final_Project/data/feature_processed/
    MODEL_SAVE_PATH: /Users/chenyi/Documents/sag/Final_Project/data/model_res/GCN
TRAIN_CONF:
    GRAPH_TYPE: Homo
    CONV_TYPE: GCN
    FEATURE_WITH_MMAP: false
    LABEL_TOPN: 0.999
    DENSE_FEATURE_NORMALIZE: true
    WANDB_PROJECT_NAME: object_construction_node_classify_gnn_model
    NUM_ClASS: 2
    EVAL_INTERNAL: 5
    TRAIN_EPOCHS: 100
    BATCH_SIZE: 128
    LEARNING_RATE: 0.001
    WEIGHT_DECAY: 0.01
    EARLY_STOP: 30
    TRAIN_SIZE: 1.0
    VAL_SIZE: 0
NETWORK_CONFIG:
    N_HEADS: 2
    N_LAYERS: 2
    HIDEN_SIZE: 512
    FAN_OUTS:
    - 10
    - 10

**********************************************************************************************************************************************************************************************
[2024-11-16 18:42:29,798] val_inference_homo.py: INFO:

loading data...
/Users/chenyi/Documents/sag/Final_Project/train_scripts/val_inference_homo.py:72: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  hetero_graph_data = torch.load(f'{pyg_graph_load_path}/PYG_HETERO_GRAPH_FOR_TRAIN.pth')
/Users/chenyi/Documents/sag/Final_Project/train_scripts/utils/utility.py:193: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(self.save_path))
[2024-11-16 18:42:29,799] val_inference_homo.py: INFO:

loading model success...
/opt/homebrew/lib/python3.11/site-packages/torch_geometric/sampler/neighbor_sampler.py:55: UserWarning: The usage of the 'directed' argument in 'NeighborSampler' is deprecated. Use `subgraph_type='induced'` instead.
  warnings.warn(f"The usage of the 'directed' argument in "
Traceback (most recent call last):
  File "/Users/chenyi/Documents/sag/Final_Project/train_scripts/pyg_homo_model_train.py", line 215, in <module>
    inference(config_file_path, stopper)
  File "/Users/chenyi/Documents/sag/Final_Project/train_scripts/val_inference_homo.py", line 97, in inference
    auc, pr_auc, ks, rec_95pre, rec_95pre_thr, pre_95rec, pre_95rec_thr = evaluate(train_dataloader, model, device)
                                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chenyi/Documents/sag/Final_Project/train_scripts/val_inference_homo.py", line 27, in evaluate
    batch_node_num = sample_data.batch_size
                     ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/torch_geometric/data/hetero_data.py", line 162, in __getattr__
    raise AttributeError(f"'{self.__class__.__name__}' has no "
AttributeError: 'HeteroData' has no attribute 'batch_size'
