[2024-11-22 14:45:30,529] pyg_homo_model_train.py: INFO:
**********************************************************************************************************************************************************************************************

MODEL ARCHITECTURE:
Graph_Model(
  (layer_convs): ModuleList(
    (0-1): 2 x GCNConv(-1, 512)
  )
  (output_layer_lin1): Linear(-1, 512, bias=True)
  (output_layer_lin2): Linear(512, 1, bias=True)
  (sigmoid): Sigmoid()
)
**********************************************************************************************************************************************************************************************
train size: 2415
val size 1327
[2024-11-22 14:45:30,531] utility.py: INFO: [EarlyStopper]: Saving model to /Users/chenyi/Documents/sag/Final_Project/code/graph_data/model_res/GCN/checkpoints/GCN_128_0.0001_0.001_2_2_512_[10, 10]_early_stop_202411221445.pth
[2024-11-22 14:45:30,531] pyg_homo_model_train.py: INFO: Train on epoch    0:
[2024-11-22 14:45:30,654] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.32007142425077056}
[2024-11-22 14:45:30,678] pyg_homo_model_train.py: INFO: epoch:0 - ROC_AUC: 0.49315589353612166; PR_AUC: 0.9953544574173843; KS: 0.013688212927756682; R@0.95P: 1.0; threhold: 0.9999998807907104; P@0.95R: 0.9908326967150497; threhold: 1.0;
[2024-11-22 14:45:30,684] pyg_homo_model_train.py: INFO: Train on epoch    1:
[2024-11-22 14:45:30,787] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 1.0344012021555664}
[2024-11-22 14:45:30,787] pyg_homo_model_train.py: INFO: Train on epoch    2:
[2024-11-22 14:45:30,897] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 2.4139051089319254}
[2024-11-22 14:45:30,898] pyg_homo_model_train.py: INFO: Train on epoch    3:
[2024-11-22 14:45:31,003] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.9675288993818975}
[2024-11-22 14:45:31,003] pyg_homo_model_train.py: INFO: Train on epoch    4:
[2024-11-22 14:45:31,110] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.20027164841537395}
[2024-11-22 14:45:31,110] pyg_homo_model_train.py: INFO: Train on epoch    5:
[2024-11-22 14:45:31,221] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.299936987055508}
[2024-11-22 14:45:31,245] pyg_homo_model_train.py: INFO: epoch:5 - ROC_AUC: 0.43079847908745245; PR_AUC: 0.9941365158743458; KS: 0.1384030418250951; R@0.95P: 1.0; threhold: 0.9999982118606567; P@0.95R: 0.9906687402799378; threhold: 0.9999998807907104;
[2024-11-22 14:45:31,249] pyg_homo_model_train.py: INFO: Train on epoch    6:
[2024-11-22 14:45:31,401] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.6622438286957534}
[2024-11-22 14:45:31,402] pyg_homo_model_train.py: INFO: Train on epoch    7:
[2024-11-22 14:45:31,508] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 1.0669581197857796}
[2024-11-22 14:45:31,508] pyg_homo_model_train.py: INFO: Train on epoch    8:
[2024-11-22 14:45:31,618] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.24962806788043698}
[2024-11-22 14:45:31,618] pyg_homo_model_train.py: INFO: Train on epoch    9:
[2024-11-22 14:45:31,734] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.576133225602146}
[2024-11-22 14:45:31,734] pyg_homo_model_train.py: INFO: Train on epoch   10:
[2024-11-22 14:45:31,845] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 1.0672773138236247}
[2024-11-22 14:45:31,875] pyg_homo_model_train.py: INFO: epoch:10 - ROC_AUC: 0.4049429657794677; PR_AUC: 0.9918927574031562; KS: 0.5627376425855513; R@0.95P: 1.0; threhold: 0.9997690320014954; P@0.95R: 0.9904912836767037; threhold: 0.9999915361404419;
[2024-11-22 14:45:31,878] pyg_homo_model_train.py: INFO: Train on epoch   11:
[2024-11-22 14:45:31,989] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.27581272875546914}
[2024-11-22 14:45:31,989] pyg_homo_model_train.py: INFO: Train on epoch   12:
[2024-11-22 14:45:32,106] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.2799698469431504}
[2024-11-22 14:45:32,106] pyg_homo_model_train.py: INFO: Train on epoch   13:
[2024-11-22 14:45:32,217] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.22497756640363184}
[2024-11-22 14:45:32,217] pyg_homo_model_train.py: INFO: Train on epoch   14:
[2024-11-22 14:45:32,327] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.18495277076280883}
[2024-11-22 14:45:32,327] pyg_homo_model_train.py: INFO: Train on epoch   15:
[2024-11-22 14:45:32,430] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.22609365897149034}
[2024-11-22 14:45:32,457] pyg_homo_model_train.py: INFO: epoch:15 - ROC_AUC: 0.43076679340937896; PR_AUC: 0.9924105079694825; KS: 0.5307984790874525; R@0.95P: 1.0; threhold: 0.9999606609344482; P@0.95R: 0.9904988123515439; threhold: 0.9999732971191406;
[2024-11-22 14:45:32,457] utility.py: INFO: EarlyStopping counter: 1 out of 30 in epoch 15

[2024-11-22 14:45:32,457] pyg_homo_model_train.py: INFO: Train on epoch   16:
[2024-11-22 14:45:32,570] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.24290851872900257}
[2024-11-22 14:45:32,570] pyg_homo_model_train.py: INFO: Train on epoch   17:
[2024-11-22 14:45:32,684] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.21064255380729216}
[2024-11-22 14:45:32,684] pyg_homo_model_train.py: INFO: Train on epoch   18:
[2024-11-22 14:45:32,790] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.180196152698426}
[2024-11-22 14:45:32,791] pyg_homo_model_train.py: INFO: Train on epoch   19:
[2024-11-22 14:45:32,898] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.2137349856072578}
[2024-11-22 14:45:32,898] pyg_homo_model_train.py: INFO: Train on epoch   20:
[2024-11-22 14:45:32,992] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.224821222420805}
[2024-11-22 14:45:33,015] pyg_homo_model_train.py: INFO: epoch:20 - ROC_AUC: 0.4159695817490494; PR_AUC: 0.9920922452808103; KS: 0.5460076045627377; R@0.95P: 1.0; threhold: 0.9994913339614868; P@0.95R: 0.9904912836767037; threhold: 0.999692440032959;
[2024-11-22 14:45:33,015] utility.py: INFO: EarlyStopping counter: 2 out of 30 in epoch 20

[2024-11-22 14:45:33,015] pyg_homo_model_train.py: INFO: Train on epoch   21:
[2024-11-22 14:45:33,125] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.19801779705298367}
[2024-11-22 14:45:33,125] pyg_homo_model_train.py: INFO: Train on epoch   22:
[2024-11-22 14:45:33,231] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.18505879406109607}
[2024-11-22 14:45:33,231] pyg_homo_model_train.py: INFO: Train on epoch   23:
[2024-11-22 14:45:33,375] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.2185150887408365}
[2024-11-22 14:45:33,375] pyg_homo_model_train.py: INFO: Train on epoch   24:
[2024-11-22 14:45:33,479] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.20871279010121127}
[2024-11-22 14:45:33,479] pyg_homo_model_train.py: INFO: Train on epoch   25:
[2024-11-22 14:45:33,579] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.18820970539720902}
[2024-11-22 14:45:33,605] pyg_homo_model_train.py: INFO: epoch:25 - ROC_AUC: 0.46004435994930293; PR_AUC: 0.9929852562154975; KS: 0.4874524714828897; R@0.95P: 1.0; threhold: 0.9986950755119324; P@0.95R: 0.9904912836767037; threhold: 0.9991689920425415;
[2024-11-22 14:45:33,605] utility.py: INFO: EarlyStopping counter: 3 out of 30 in epoch 25

[2024-11-22 14:45:33,605] pyg_homo_model_train.py: INFO: Train on epoch   26:
[2024-11-22 14:45:33,753] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.1947250983976676}
[2024-11-22 14:45:33,753] pyg_homo_model_train.py: INFO: Train on epoch   27:
[2024-11-22 14:45:33,866] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.19831223004106163}
[2024-11-22 14:45:33,866] pyg_homo_model_train.py: INFO: Train on epoch   28:
[2024-11-22 14:45:33,972] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.19444912850980187}
[2024-11-22 14:45:33,972] pyg_homo_model_train.py: INFO: Train on epoch   29:
[2024-11-22 14:45:34,081] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.18894900587034522}
[2024-11-22 14:45:34,081] pyg_homo_model_train.py: INFO: Train on epoch   30:
[2024-11-22 14:45:34,186] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.1912728760553443}
[2024-11-22 14:45:34,210] pyg_homo_model_train.py: INFO: epoch:30 - ROC_AUC: 0.463149556400507; PR_AUC: 0.9930238977073806; KS: 0.4653992395437262; R@0.95P: 1.0; threhold: 0.9975720047950745; P@0.95R: 0.9904912836767037; threhold: 0.9990757703781128;
[2024-11-22 14:45:34,210] utility.py: INFO: EarlyStopping counter: 4 out of 30 in epoch 30

[2024-11-22 14:45:34,210] pyg_homo_model_train.py: INFO: Train on epoch   31:
[2024-11-22 14:45:34,313] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.18840601697224763}
[2024-11-22 14:45:34,313] pyg_homo_model_train.py: INFO: Train on epoch   32:
[2024-11-22 14:45:34,436] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.18744857348270297}
[2024-11-22 14:45:34,436] pyg_homo_model_train.py: INFO: Train on epoch   33:
[2024-11-22 14:45:34,555] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.18788068232822616}
[2024-11-22 14:45:34,555] pyg_homo_model_train.py: INFO: Train on epoch   34:
[2024-11-22 14:45:34,671] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.19658872335840702}
[2024-11-22 14:45:34,671] pyg_homo_model_train.py: INFO: Train on epoch   35:
[2024-11-22 14:45:34,778] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.1949529769257729}
[2024-11-22 14:45:34,801] pyg_homo_model_train.py: INFO: epoch:35 - ROC_AUC: 0.4804499366286438; PR_AUC: 0.9933498672968049; KS: 0.44030418250950565; R@0.95P: 1.0; threhold: 0.9971939325332642; P@0.95R: 0.9904912836767037; threhold: 0.9990047812461853;
[2024-11-22 14:45:34,801] utility.py: INFO: EarlyStopping counter: 5 out of 30 in epoch 35

[2024-11-22 14:45:34,801] pyg_homo_model_train.py: INFO: Train on epoch   36:
[2024-11-22 14:45:34,914] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.1837113887133312}
[2024-11-22 14:45:34,915] pyg_homo_model_train.py: INFO: Train on epoch   37:
[2024-11-22 14:45:35,032] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.1854820460513018}
[2024-11-22 14:45:35,032] pyg_homo_model_train.py: INFO: Train on epoch   38:
[2024-11-22 14:45:35,148] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.18611549252555484}
[2024-11-22 14:45:35,149] pyg_homo_model_train.py: INFO: Train on epoch   39:
[2024-11-22 14:45:35,258] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.17914147791655166}
[2024-11-22 14:45:35,258] pyg_homo_model_train.py: INFO: Train on epoch   40:
[2024-11-22 14:45:35,356] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.1888956901079379}
[2024-11-22 14:45:35,400] pyg_homo_model_train.py: INFO: epoch:40 - ROC_AUC: 0.5166349809885931; PR_AUC: 0.9939070328562127; KS: 0.38479087452471483; R@0.95P: 1.0; threhold: 0.9961114525794983; P@0.95R: 0.9904988123515439; threhold: 0.999016284942627;
[2024-11-22 14:45:35,400] utility.py: INFO: EarlyStopping counter: 6 out of 30 in epoch 40

[2024-11-22 14:45:35,400] pyg_homo_model_train.py: INFO: Train on epoch   41:
[2024-11-22 14:45:35,527] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.1816375249908084}
[2024-11-22 14:45:35,528] pyg_homo_model_train.py: INFO: Train on epoch   42:
[2024-11-22 14:45:35,635] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.18095515566583006}
[2024-11-22 14:45:35,635] pyg_homo_model_train.py: INFO: Train on epoch   43:
[2024-11-22 14:45:35,749] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.19049235379967383}
[2024-11-22 14:45:35,749] pyg_homo_model_train.py: INFO: Train on epoch   44:
[2024-11-22 14:45:35,857] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.18487377662836393}
[2024-11-22 14:45:35,857] pyg_homo_model_train.py: INFO: Train on epoch   45:
[2024-11-22 14:45:35,965] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.1790264426181035}
[2024-11-22 14:45:35,988] pyg_homo_model_train.py: INFO: epoch:45 - ROC_AUC: 0.47357414448669205; PR_AUC: 0.9931991122256003; KS: 0.42509505703422057; R@0.95P: 1.0; threhold: 0.9957244396209717; P@0.95R: 0.9904912836767037; threhold: 0.9991414546966553;
[2024-11-22 14:45:35,988] utility.py: INFO: EarlyStopping counter: 7 out of 30 in epoch 45

[2024-11-22 14:45:35,988] pyg_homo_model_train.py: INFO: Train on epoch   46:
[2024-11-22 14:45:36,093] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.18559780051742775}
[2024-11-22 14:45:36,093] pyg_homo_model_train.py: INFO: Train on epoch   47:
[2024-11-22 14:45:36,203] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.18038905546778725}
[2024-11-22 14:45:36,203] pyg_homo_model_train.py: INFO: Train on epoch   48:
[2024-11-22 14:45:36,313] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.17950491915084807}
[2024-11-22 14:45:36,313] pyg_homo_model_train.py: INFO: Train on epoch   49:
[2024-11-22 14:45:36,415] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.17404910061917198}
[2024-11-22 14:45:36,415] pyg_homo_model_train.py: INFO: Train on epoch   50:
[2024-11-22 14:45:36,526] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.18605676252649436}
[2024-11-22 14:45:36,551] pyg_homo_model_train.py: INFO: epoch:50 - ROC_AUC: 0.7065272496831433; PR_AUC: 0.9965858491378046; KS: 0.41216730038022814; R@0.95P: 1.0; threhold: 0.9932143688201904; P@0.95R: 0.9904912836767037; threhold: 0.9988118410110474;
[2024-11-22 14:45:36,551] utility.py: INFO: EarlyStopping counter: 8 out of 30 in epoch 50

[2024-11-22 14:45:36,551] pyg_homo_model_train.py: INFO: Train on epoch   51:
[2024-11-22 14:45:36,669] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.1803973940835483}
[2024-11-22 14:45:36,669] pyg_homo_model_train.py: INFO: Train on epoch   52:
[2024-11-22 14:45:36,776] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.18316502405743174}
[2024-11-22 14:45:36,776] pyg_homo_model_train.py: INFO: Train on epoch   53:
[2024-11-22 14:45:36,889] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.18248904496739862}
[2024-11-22 14:45:36,890] pyg_homo_model_train.py: INFO: Train on epoch   54:
[2024-11-22 14:45:37,011] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.18302883416969584}
[2024-11-22 14:45:37,011] pyg_homo_model_train.py: INFO: Train on epoch   55:
[2024-11-22 14:45:37,126] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.1785729478111425}
[2024-11-22 14:45:37,153] pyg_homo_model_train.py: INFO: epoch:55 - ROC_AUC: 0.5280735107731305; PR_AUC: 0.9940953217524473; KS: 0.3931558935361217; R@0.95P: 1.0; threhold: 0.9973235726356506; P@0.95R: 0.9904912836767037; threhold: 0.9995346069335938;
[2024-11-22 14:45:37,153] utility.py: INFO: EarlyStopping counter: 9 out of 30 in epoch 55

[2024-11-22 14:45:37,153] pyg_homo_model_train.py: INFO: Train on epoch   56:
[2024-11-22 14:45:37,274] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.18605801403892708}
[2024-11-22 14:45:37,274] pyg_homo_model_train.py: INFO: Train on epoch   57:
[2024-11-22 14:45:37,407] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.17098989153500668}
[2024-11-22 14:45:37,407] pyg_homo_model_train.py: INFO: Train on epoch   58:
[2024-11-22 14:45:37,554] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.1840199166943568}
[2024-11-22 14:45:37,554] pyg_homo_model_train.py: INFO: Train on epoch   59:
[2024-11-22 14:45:37,656] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.1763114910071434}
[2024-11-22 14:45:37,656] pyg_homo_model_train.py: INFO: Train on epoch   60:
[2024-11-22 14:45:37,759] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.18083607149667127}
[2024-11-22 14:45:37,779] pyg_homo_model_train.py: INFO: epoch:60 - ROC_AUC: 0.6804816223067174; PR_AUC: 0.9962487626523034; KS: 0.40792141951837774; R@0.95P: 1.0; threhold: 0.98451828956604; P@0.95R: 0.9904912836767037; threhold: 0.9980423450469971;
[2024-11-22 14:45:37,780] utility.py: INFO: EarlyStopping counter: 10 out of 30 in epoch 60

[2024-11-22 14:45:37,780] pyg_homo_model_train.py: INFO: Train on epoch   61:
[2024-11-22 14:45:37,908] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.17530856532339725}
[2024-11-22 14:45:37,908] pyg_homo_model_train.py: INFO: Train on epoch   62:
[2024-11-22 14:45:38,035] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.1775116983407773}
[2024-11-22 14:45:38,035] pyg_homo_model_train.py: INFO: Train on epoch   63:
[2024-11-22 14:45:38,147] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.1761996246766353}
[2024-11-22 14:45:38,148] pyg_homo_model_train.py: INFO: Train on epoch   64:
[2024-11-22 14:45:38,264] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.17626967630030946}
[2024-11-22 14:45:38,265] pyg_homo_model_train.py: INFO: Train on epoch   65:
[2024-11-22 14:45:38,362] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.17562059950137485}
[2024-11-22 14:45:38,384] pyg_homo_model_train.py: INFO: epoch:65 - ROC_AUC: 0.8023764258555133; PR_AUC: 0.9978330153843173; KS: 0.6033586818757921; R@0.95P: 1.0; threhold: 0.9789615273475647; P@0.95R: 0.9904912836767037; threhold: 0.9974507689476013;
[2024-11-22 14:45:38,387] pyg_homo_model_train.py: INFO: Train on epoch   66:
[2024-11-22 14:45:38,480] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.17227253516515095}
[2024-11-22 14:45:38,480] pyg_homo_model_train.py: INFO: Train on epoch   67:
[2024-11-22 14:45:38,601] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.1735787741022327}
[2024-11-22 14:45:38,601] pyg_homo_model_train.py: INFO: Train on epoch   68:
[2024-11-22 14:45:38,768] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.17467356172407636}
[2024-11-22 14:45:38,768] pyg_homo_model_train.py: INFO: Train on epoch   69:
[2024-11-22 14:45:38,891] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.17731216491872973}
[2024-11-22 14:45:38,892] pyg_homo_model_train.py: INFO: Train on epoch   70:
[2024-11-22 14:45:39,011] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.17248931941778764}
[2024-11-22 14:45:39,036] pyg_homo_model_train.py: INFO: epoch:70 - ROC_AUC: 0.7488910012674271; PR_AUC: 0.9971219695204154; KS: 0.4740811153358682; R@0.95P: 1.0; threhold: 0.9878506064414978; P@0.95R: 0.9904912836767037; threhold: 0.9988152980804443;
[2024-11-22 14:45:39,036] utility.py: INFO: EarlyStopping counter: 1 out of 30 in epoch 70

[2024-11-22 14:45:39,036] pyg_homo_model_train.py: INFO: Train on epoch   71:
[2024-11-22 14:45:39,154] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.17609656841858573}
[2024-11-22 14:45:39,154] pyg_homo_model_train.py: INFO: Train on epoch   72:
[2024-11-22 14:45:39,263] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.16985064890567314}
[2024-11-22 14:45:39,263] pyg_homo_model_train.py: INFO: Train on epoch   73:
[2024-11-22 14:45:39,364] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.17217895943925987}
[2024-11-22 14:45:39,364] pyg_homo_model_train.py: INFO: Train on epoch   74:
[2024-11-22 14:45:39,473] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.16735021452232424}
[2024-11-22 14:45:39,473] pyg_homo_model_train.py: INFO: Train on epoch   75:
[2024-11-22 14:45:39,599] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.1739744386070757}
[2024-11-22 14:45:39,624] pyg_homo_model_train.py: INFO: epoch:75 - ROC_AUC: 0.773637515842839; PR_AUC: 0.9975098942730678; KS: 0.5455640050697085; R@0.95P: 1.0; threhold: 0.962653398513794; P@0.95R: 0.9904912836767037; threhold: 0.9970922470092773;
[2024-11-22 14:45:39,624] utility.py: INFO: EarlyStopping counter: 2 out of 30 in epoch 75

[2024-11-22 14:45:39,624] pyg_homo_model_train.py: INFO: Train on epoch   76:
[2024-11-22 14:45:39,732] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.17181185791211098}
[2024-11-22 14:45:39,732] pyg_homo_model_train.py: INFO: Train on epoch   77:
[2024-11-22 14:45:39,866] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.1758969257460371}
[2024-11-22 14:45:39,866] pyg_homo_model_train.py: INFO: Train on epoch   78:
[2024-11-22 14:45:40,046] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.16717628879823546}
[2024-11-22 14:45:40,046] pyg_homo_model_train.py: INFO: Train on epoch   79:
[2024-11-22 14:45:40,159] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.16905042145316398}
[2024-11-22 14:45:40,159] pyg_homo_model_train.py: INFO: Train on epoch   80:
[2024-11-22 14:45:40,293] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.16556556674017422}
[2024-11-22 14:45:40,315] pyg_homo_model_train.py: INFO: epoch:80 - ROC_AUC: 0.6723384030418251; PR_AUC: 0.9960194985005073; KS: 0.3665399239543726; R@0.95P: 1.0; threhold: 0.9916871190071106; P@0.95R: 0.9904912836767037; threhold: 0.9994774460792542;
[2024-11-22 14:45:40,315] utility.py: INFO: EarlyStopping counter: 3 out of 30 in epoch 80

[2024-11-22 14:45:40,315] pyg_homo_model_train.py: INFO: Train on epoch   81:
[2024-11-22 14:45:40,434] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.1754707129969113}
[2024-11-22 14:45:40,434] pyg_homo_model_train.py: INFO: Train on epoch   82:
[2024-11-22 14:45:40,550] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.16379731577622472}
[2024-11-22 14:45:40,550] pyg_homo_model_train.py: INFO: Train on epoch   83:
[2024-11-22 14:45:40,651] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.18520912444122584}
[2024-11-22 14:45:40,651] pyg_homo_model_train.py: INFO: Train on epoch   84:
[2024-11-22 14:45:40,755] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.16620768570258257}
[2024-11-22 14:45:40,755] pyg_homo_model_train.py: INFO: Train on epoch   85:
[2024-11-22 14:45:40,863] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.17739050013184796}
[2024-11-22 14:45:40,886] pyg_homo_model_train.py: INFO: epoch:85 - ROC_AUC: 0.7587769328263625; PR_AUC: 0.9972607357488873; KS: 0.5083016476552598; R@0.95P: 1.0; threhold: 0.9209907054901123; P@0.95R: 0.9904912836767037; threhold: 0.9936352968215942;
[2024-11-22 14:45:40,886] utility.py: INFO: EarlyStopping counter: 4 out of 30 in epoch 85

[2024-11-22 14:45:40,886] pyg_homo_model_train.py: INFO: Train on epoch   86:
[2024-11-22 14:45:41,000] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.16997207224245645}
[2024-11-22 14:45:41,000] pyg_homo_model_train.py: INFO: Train on epoch   87:
[2024-11-22 14:45:41,124] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.1793556262740931}
[2024-11-22 14:45:41,124] pyg_homo_model_train.py: INFO: Train on epoch   88:
[2024-11-22 14:45:41,240] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.1631430088609889}
[2024-11-22 14:45:41,240] pyg_homo_model_train.py: INFO: Train on epoch   89:
[2024-11-22 14:45:41,370] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.17453602567222548}
[2024-11-22 14:45:41,370] pyg_homo_model_train.py: INFO: Train on epoch   90:
[2024-11-22 14:45:41,486] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.16378997147206686}
[2024-11-22 14:45:41,510] pyg_homo_model_train.py: INFO: epoch:90 - ROC_AUC: 0.7018060836501901; PR_AUC: 0.996441478350275; KS: 0.40183776932826365; R@0.95P: 1.0; threhold: 0.9883708953857422; P@0.95R: 0.9904912836767037; threhold: 0.9992708563804626;
[2024-11-22 14:45:41,510] utility.py: INFO: EarlyStopping counter: 5 out of 30 in epoch 90

[2024-11-22 14:45:41,510] pyg_homo_model_train.py: INFO: Train on epoch   91:
[2024-11-22 14:45:41,672] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.17490243001013808}
[2024-11-22 14:45:41,672] pyg_homo_model_train.py: INFO: Train on epoch   92:
[2024-11-22 14:45:41,796] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.16271132613314357}
[2024-11-22 14:45:41,796] pyg_homo_model_train.py: INFO: Train on epoch   93:
[2024-11-22 14:45:41,919] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.17337536779743298}
[2024-11-22 14:45:41,919] pyg_homo_model_train.py: INFO: Train on epoch   94:
[2024-11-22 14:45:42,036] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.1615877083986689}
[2024-11-22 14:45:42,036] pyg_homo_model_train.py: INFO: Train on epoch   95:
[2024-11-22 14:45:42,162] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.17629398274125518}
[2024-11-22 14:45:42,189] pyg_homo_model_train.py: INFO: epoch:95 - ROC_AUC: 0.8619771863117871; PR_AUC: 0.9985980378054046; KS: 0.729594423320659; R@0.95P: 1.0; threhold: 0.8727275133132935; P@0.95R: 0.9904912836767037; threhold: 0.9892644286155701;
[2024-11-22 14:45:42,191] pyg_homo_model_train.py: INFO: Train on epoch   96:
[2024-11-22 14:45:42,326] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.16233382255887888}
[2024-11-22 14:45:42,326] pyg_homo_model_train.py: INFO: Train on epoch   97:
[2024-11-22 14:45:42,724] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.169987223076771}
[2024-11-22 14:45:42,724] pyg_homo_model_train.py: INFO: Train on epoch   98:
[2024-11-22 14:45:42,860] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.1685869398447791}
[2024-11-22 14:45:42,860] pyg_homo_model_train.py: INFO: Train on epoch   99:
[2024-11-22 14:45:42,969] pyg_homo_model_train.py: INFO: {'train/loss/epoch': 0.1690104661644369}
[2024-11-22 14:45:42,969] pyg_homo_model_train.py: INFO:
Best Epoch 95, Val 0.7296
/Users/chenyi/Documents/sag/Final_Project/code/train_scripts/utils/utility.py:193: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(self.save_path))
[2024-11-22 14:45:42,994] pyg_homo_model_train.py: INFO:
Best Epoch 95 - ROC_AUC: 0.8610899873257288; PR_AUC: 0.9985852804665845; KS: 0.7219898605830164; R@0.95P: 1.0; threhold: 0.8719896078109741; P@0.95R: 0.9904912836767037; threhold: 0.989365816116333;
[2024-11-22 14:45:42,994] val_inference_homo.py: INFO: config file path is train_scripts/config/config.yaml
[2024-11-22 14:45:42,999] val_inference_homo.py: INFO:
**********************************************************************************************************************************************************************************************

DATASET_CONFIG:
DATASET_PATH:
    EDGE_TYPES:
    - class_to_class
    SAVE2FILE_ROOTPATH: /Users/chenyi/Documents/sag/Final_Project/code/graph_data
    NODE_FEATURE_SAVE2FILE_PATH: /Users/chenyi/Documents/sag/Final_Project/code/graph_data/{DATA_TYPE}/node_feature
    EDGE_INDEX_SAVE2FILE_PATH: /Users/chenyi/Documents/sag/Final_Project/code/graph_data/{DATA_TYPE}/edge_index
    PYG_GRAPH_SAVE2FILE_PATH: /Users/chenyi/Documents/sag/Final_Project/code/graph_data/pyg_graph/{DATA_TYPE}
    FEATURE_SAVE2FILE_PATH: /Users/chenyi/Documents/sag/Final_Project/code/graph_data/feature_processed/
    MODEL_SAVE_PATH: /Users/chenyi/Documents/sag/Final_Project/code/graph_data/model_res/GCN
TRAIN_CONF:
    GRAPH_TYPE: Homo
    CONV_TYPE: GCN
    FEATURE_WITH_MMAP: false
    LABEL_TOPN: 0.999
    DENSE_FEATURE_NORMALIZE: true
    WANDB_PROJECT_NAME: object_construction_node_classify_gnn_model
    NUM_ClASS: 2
    EVAL_INTERNAL: 5
    TRAIN_EPOCHS: 100
    BATCH_SIZE: 128
    LEARNING_RATE: 0.0001
    WEIGHT_DECAY: 0.001
    EARLY_STOP: 30
    TRAIN_SIZE: 1.0
    VAL_SIZE: 0
NETWORK_CONFIG:
    N_HEADS: 2
    N_LAYERS: 2
    HIDEN_SIZE: 512
    FAN_OUTS:
    - 10
    - 10

**********************************************************************************************************************************************************************************************
[2024-11-22 14:45:43,000] val_inference_homo.py: INFO:

loading data...
/Users/chenyi/Documents/sag/Final_Project/code/train_scripts/val_inference_homo.py:72: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  homo_graph_data = torch.load(f'{pyg_graph_load_path}/PYG_HETERO_GRAPH_FOR_TRAIN.pth').to_homogeneous()
/Users/chenyi/Documents/sag/Final_Project/code/train_scripts/utils/utility.py:193: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(self.save_path))
[2024-11-22 14:45:43,003] val_inference_homo.py: INFO:

loading model success...
/opt/homebrew/lib/python3.11/site-packages/torch_geometric/sampler/neighbor_sampler.py:55: UserWarning: The usage of the 'directed' argument in 'NeighborSampler' is deprecated. Use `subgraph_type='induced'` instead.
  warnings.warn(f"The usage of the 'directed' argument in "
auc:0.8593472750316857
pr_auc:0.9985775885696884
ks:0.7067807351077313
rec_95pre:1.0
rec_95pre_thr:0.8641347289085388
pre_95rec:0.9904912836767037
pre_95rec_thr:0.9895880222320557
